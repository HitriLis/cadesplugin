// тестовый фаил .png
const testBase64String = "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MC8iPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MjQ2PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjE0Nzg8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpVc2VyQ29tbWVudD5TY3JlZW5zaG90PC9leGlmOlVzZXJDb21tZW50PgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KlF/6aAAAABxpRE9UAAAAAgAAAAAAAAB7AAAAKAAAAHsAAAB7AAARgkaoILYAABFOSURBVHgB7N1tTyIxFAbQAQTd//9fXUFeNpcE47riuktpp72nCUFEp73n9tOTSWfx/Px8mgwCBAgQIECAAAECBAgQIECAAAECBAgQIJBEYCEYT9JpZRIgQIAAAQIECBAgQIAAAQIECBAgQIDAWUAwbiMQIECAAAECBAgQIECAAAECBAgQIECAQCoBwXiqdiuWAAECBAgQIECAAAECBAgQIECAAAECBATj9gABAgQIECBAgAABAgQIECBAgAABAgQIpBIQjKdqt2IJECBAgAABAgQIECBAgAABAgQIECBAQDBuDxAgQIAAAQIECBAgQIAAAQIECBAgQIBAKgHBeKp2K5YAAQIECBAgQIAAAQIECBAgQIAAAQIEBOP2AAECBAgQIECAAAECBAgQIECAAAECBAikEhCMp2q3YgkQIECAAAECBAgQIECAAAECBAgQIEBAMG4PECBAgAABAgQIECBAgAABAgQIECBAgEAqAcF4qnYrlgABAgQIECBAgAABAgQIECBAgAABAgQE4/YAAQIECBAgQIAAAQIECBAgQIAAAQIECKQSEIynardiCRAgQIAAAQIECBAgQIAAAQIECBAgQEAwbg8QIECAAAECBAgQIECAAAECBAgQIECAQCoBwXiqdiuWAAECBAgQIECAAAECBAgQIECAAAECBATj9gABAgQIECBAgAABAgQIECBAgAABAgQIpBIQjKdqt2IJECBAgAABAgQIECBAgAABAgQIECBAQDBuDxAgQIAAAQIECBAgQIAAAQIECBAgQIBAKgHBeKp2K5YAAQIECBAgQIAAAQIECBAgQIAAAQIEBOP2AAECBAgQIECAAAECBAgQIECAAAECBAikEhCMp2q3YgkQIECAAAECBAgQIECAAAECBAgQIEBAMG4PECBAgAABAgQIECBAgAABAgQIECBAgEAqAcF4qnYrlgABAgQIECBAgAABAgQIECBAgAABAgQE4/YAAQIECBAgQIAAAQIECBAgQIAAAQIECKQSEIynardiCRAgQIAAAQIECBAgQIAAAQIECBAgQEAwbg8QIECAAAECBAgQIECAAAECBAgQIECAQCoBwXiqdiuWAAECBAgQIECAAAECBAgQIECAAAECBATj9gABAgQIECBAgAABAgQIECBAgAABAgQIpBIQjKdqt2IJECBAgAABAgQIECBAgAABAgQIECBAQDBuDxAgQIAAAQIECBAgQIAAAQIECBAgQIBAKgHBeKp2K5YAAQIECBAgQIAAAQIECBAgQIAAAQIEBOP2AAECBAgQIECAAAECBAgQIECAAAECBAikEhCMp2q3YgkQIECAAAECBAgQIECAAAECBAgQIEBAMG4PECBAgAABAgQIECBAgAABAgQIECBAgEAqAcF4qnYrlgABAgQIECBAgAABAgQIECBAgAABAgQE4/YAAQIECBAgQIAAAQIECBAgQIAAAQIECKQSEIynardiCRAgQIAAAQIECBAgQIAAAQIECBAgQEAwbg8QIECAAAECBAgQIECAAAECBAgQIECAQCoBwXiqdiuWAAECBAgQIECAAAECBAgQIECAAAECBATj9gABAgQIECBAgAABAgQIECBAgAABAgQIpBIQjKdqt2IJECBAgAABAgQIECBAgAABAgQIECBAQDBuDxAgQIAAAQIECBAgQIAAAQIECBAgQIBAKgHBeKp2K5YAAQIECBAgQIAAAQIECBAgQIAAAQIEBOP2AAECBAgQIECAAAECBAgQIECAAAECBAikEhCMp2q3YgkQIECAAAECBAgQIECAAAECBAgQIEBAMG4PECBAgAABAgQIECBAgAABAgQIECBAgEAqAcF4qnYrlgABAgQIECBAgAABAgQIECBAgAABAgQE4/YAAQIECBAgQIAAAQIECBAgQIAAAQIECKQSEIynardiCRAgQIAAAQIECBAgQIAAAQIECBAgQEAwbg8QIECAAAECBAgQIECAAAECBAgQIECAQCoBwXiqdiuWAAECBAgQIECAAAECBAgQIECAAAECBATj9gABAgQIECBAgAABAgQIECBAgAABAgQIpBIQjKdqt2IJECBAgAABAgQIECBAgAABAgQIECBAQDBuDxAgQIAAAQIECBAgQIAAAQIECBAgQIBAKgHBeKp2K5YAAQIECBAgQIAAAQIECBAgQIAAAQIEBOP2AAECBAgQIECAAAECBAgQIECAAAECBAikEhCMp2q3YgkQIECAAAECBAgQIECAAAECBAgQIEBAMG4PECBAgAABAgQIECBAgAABAgQIECBAgEAqAcF4qnYrlgABAgQIECBAgAABAgQIECBAgAABAgQE4/YAAQIECBAgQIAAAQIECBAgQIAAAQIECKQSEIynardiCRAgQIAAAQIECBAgQIAAAQIECBAgQEAwbg8QIECAAAECBAgQIECAAAECBAgQIECAQCoBwXiqdiuWAAECBAgQIECAAAECBAgQIECAAAECBATj9gABAgTuILBYLKZ4LZfL8/vlc7zHuLzfYWqXJECAAAECBAgQIECAAIEvBE6n0/nbeH//Oh6Pb5+/+HdfESAwiIBgfJBGKoMAgbYClxA8gvDLq+2KzE6AAAECBAgQIECAAAEC/yMQAfn71yVI/59r+R8CBOYrIBifb2+sjACBmQtEGL5arc6vCMMNAgQIECBAgAABAgQIEBhPIELyw+FwfgnJx+uvivIKCMbz9l7lBAj8p8AlDI93gwABAgQIECBAgAABAgTyCFwC8ng3CBDoW0Aw3nf/rJ4AgYoCDw8P7g6v6G0qAgQIECBAgAABAgQIzFXgchf5fr+f6xKtiwCBvwgIxv8C5GsCBAhEIB4vD8y0FwgQIECAAAECBAgQIEDgvUAcrRLhuID8vYqfCfQhIBjvo09WSYBAA4E4KiUCceeHN8A3JQECBAgQIECAAAECBDoSiDvIIxx3xEpHTbPU9AKC8fRbAAABAh8F4s7w9Xp9Pjbl43c+EyBAgAABAgQIECBAgACBawIRjL++vk4e0nlNyO8JzEdAMD6fXlgJAQIzEIi7xCMUd2zKDJphCQQIECBAgAABAgQIEOhQIELxCMfdPd5h8yw5lYBgPFW7FUuAwFcCEYjH0SkGAQIECBAgQIAAAQIECBC4VSCOVomA3CBAYJ4CgvF59sWqCBCoKBB3h282G2eJVzQ3FQECBAgQIECAAAECBDIIxNnju93O0SoZmq3G7gQE4921zIIJECgp4OiUkpquRYAAAQIECBAgQIAAAQIfBRyt8lHEZwLzEBCMz6MPVkGAQAOBCMXjTnGDAAECBAgQIECAAAECBAjcWyDuHHfu+L2VXZ/A9wUE49+38pcECAwkEGeJx5niBgECBAgQIECAAAECBAgQqCUQZ47H2eMGAQLtBQTj7XtgBQQIVBYQilcGNx0BAgQIECBAgAABAgQIvAkIx98o/ECgqYBgvCm/yQkQqC3g+JTa4uYjQIAAAQIECBAgQIAAgY8CjlX5KOIzgfoCgvH65mYkQKCRgFC8EbxpCRAgQIAAAQIECBAgQOAPAeH4HyR+QaCqgGC8KrfJCBBoJbBYLKbHx8cp3g0CBAgQIECAAAECBAgQINBa4HQ6Tdvtdop3gwCB+gKC8frmZiRAoIFAhOLL5bLBzKYkQIAAAQIECBAgQIAAAQKfCxyPx3M4/vm3fkuAwD0FBOP31HVtAgRmIbBer6d44KZBgAABAgQIECBAgAABAgTmJrDf76d4IKdBgEBdAcF4XW+zESBQWcC54pXBTUeAAAECBAgQIECAAAEC/yzgvPF/JvMPBG4WEIzfTOgCBAjMVcC54nPtjHURIECAAAECBAgQIECAwHsB542/1/AzgToCgvE6zmYhQKCBwGazmeKOcYMAAQIECBAgQIAAAQIECMxd4HA4THHnuEGAQB0BwXgdZ7MQIFBZwBEqlcFNR4AAAQIECBAgQIAAAQI3CzhS5WZCFyDwbQHB+Lep/CEBAj0JPD4+TsvlsqclWysBAgQIECBAgAABAgQIJBc4Ho/TdrtNrqB8AnUEBON1nM1CgEBFgYeHh2m9Xlec0VQECBAgQIAAAQIECBAgQKCMwOvr67Tf78tczFUIELgqIBi/SuMLAgR6FXh6epriwZsGAQIECBAgQIAAAQIECBDoTSAexPny8tLbsq2XQHcCgvHuWmbBBAh8JeBu8a90fEeAAAECBAgQIECAAAECPQi4a7yHLllj7wKC8d47aP0ECPwm4Gzx3zh8IECAAAECBAgQIECAAIEOBZw13mHTLLk7AcF4dy2zYAIErgmsVqtps9lc+9rvCRAgQIAAAQIECBAgQIBANwK73W46HA7drNdCCfQmIBjvrWPWS4DAVYEIxSMcNwgQIECAAAECBAgQIECAQO8CEYpHOG4QIHAfAcH4fVxdlQCBygLxsM146KZBgAABAgQIECBAgAABAgRGEYiHcMbDOA0CBMoLCMbLm7oiAQINBDx0swG6KQkQIECAAAECBAgQIEDgrgIewnlXXhdPLiAYT74BlE9gFAEP3Rylk+ogQIAAAQIECBAgQIAAgYuAh3BeJLwTKC8gGC9v6ooECFQWcIxKZXDTESBAgAABAgQIECBAgEA1AcepVKM2UTIBwXiyhiuXwIgC8cDNePCmQYAAAQIECBAgQIAAAQIERhOIB3DGgzgNAgTKCgjGy3q6GgECDQTW6/UUZ4wbBAgQIECAAAECBAgQIEBgNIH9fj/FWeMGAQJlBQTjZT1djQCBBgLOF2+AbkoCBAgQIECAAAECBAgQqCLgnPEqzCZJKCAYT9h0JRMYScD54iN1Uy0ECBAgQIAAAQIECBAg8JmAc8Y/U/E7ArcJCMZv8/PfBAg0Flgul1PcMW4QIECAAAECBAgQIECAAIFRBbbb7RR3jhsECJQTEIyXs3QlAgQaCMTZ4nHGuEGAAAECBAgQIECAAAECBEYViDPG46xxgwCBcgKC8XKWrkSAQAMBD95sgG5KAgQIECBAgAABAgQIEKgq4AGcVblNlkRAMJ6k0cokMKrAZrOZVqvVqOWpiwABAgQIECBAgAABAgQITIfDYdrtdiQIECgoIBgviOlSBAjUF4jzxeOccYMAAQIECBAgQIAAAQIECIwqEOeLxznjBgEC5QQE4+UsXYkAgQYCT09P02KxaDCzKQkQIECAAAECBAgQIECAQB2B0+k0vby81JnMLASSCAjGkzRamQRGFRCMj9pZdREgQIAAAQIECBAgQIDARUAwfpHwTqCcgGC8nKUrESDQQODHjx8NZjUlAQIECBAgQIAAAQIECBCoK/Dz58+6E5qNwOACgvHBG6w8AqMLCMZH77D6CBAgQIAAAQIECBAgQCAEBOP2AYGyAoLxsp6uRoBAZQHBeGVw0xEgQIAAAQIECBAgQIBAEwHBeBN2kw4sIBgfuLlKI5BBQDCeoctqJECAAAECBAgQIECAAAHBuD1AoKyAYLysp6sRIFBZQDBeGdx0BAgQIECAAAECBAgQINBEQDDehN2kAwsIxgdurtIIZBAQjGfoshoJECBAgAABAgQIECBAQDBuDxAoKyAYL+vpagQIVBYQjFcGNx0BAgQIECBAgAABAgQINBEQjDdhN+nAAoLxgZurNAIZBATjGbqsRgIECBAgQIAAAQIECBAQjNsDBMoKCMbLeroaAQKVBQTjlcFNR4AAAQIECBAgQIAAAQJNBATjTdhNOrCAYHzg5iqNQAYBwXiGLquRAAECBAgQIECAAAECBATj9gCBsgKC8bKerkaAQGUBwXhlcNMRIECAAAECBAgQIECAQBMBwXgTdpMOLCAYH7i5SiOQQUAwnqHLaiRAgAABAgQIECBAgAABwbg9QKCsgGC8rKerESBQWUAwXhncdAQIECBAgAABAgQIECDQREAw3oTdpAML/AIAAP//5vF6NgAAJvVJREFU7d0JkBXVvcfx/wwjY3RgWGSNyCYkgiSgEcoiCVKTBFGQEghEi9Ugm2wpFpHNAQVBIIAEWSQSCJuBIBI0MQmJAqHYQgERBAkShQgWYZk4EBhmhvfO9Q0BXvednjt9u885/e2qqZnbp2+f//n8b5X6s+vclIsXL14VDgQQQMBQga985SuGVk7ZCCCAAAIIIIAAAggggAACCHgX+M9//uP9Yq5EAIFiBVIIxos14gIEENBYgGBc4+ZQGgIIIIAAAggggAACCCCAgG8CBOO+UXIjBGICBON8EBBAwGgBgnGj20fxCCCAAAIIIIAAAggggAACHgUIxj1CcRkCHgUIxj1CcRkCCOgpQDCuZ1+oCgEEEEAAAQQQQAABBBBAwF8BgnF/PbkbAgTjfAYQQMBoAYJxo9tH8QgggAACCCCAAAIIIIAAAh4FCMY9QnEZAh4FCMY9QnEZAgjoKUAwrmdfqAoBBBBAAAEEEEAAAQQQQMBfAYJxfz25GwIE43wGEEDAaAGCcaPbR/EIIIAAAggggAACCCCAAAIeBQjGPUJxGQIeBQjGPUJxGQII6ClAMK5nX6gKAQQQQAABBBBAAAEEEEDAXwGCcX89uRsCBON8BhBAwGgBgnGj20fxCCCAAAIIIIAAAggggAACHgUIxj1CcRkCHgUIxj1CcRkCCOgpQDCuZ1+oCgEEEEAAAQQQQAABBBBAwF8BgnF/PbkbAgTjfAYQQMBoAYJxo9tH8QgggAACCCCAAAIIIIAAAh4FCMY9QnEZAh4FCMY9QnEZAgjoKUAwrmdfqAoBBBBAAAEEEEAAAQQQQMBfAYJxfz25GwIE43wGEEDAaAGCcaPbR/EIIIAAAggggAACCCCAAAIeBQjGPUJxGQIeBQjGPUJxGQII6ClAMK5nX6gKAQQQQAABBBBAAAEEEEDAXwGCcX89uRsCBON8BhBAwGgBgnGj20fxCCCAAAIIIIAAAggggAACHgUIxj1CcRkCHgUIxj1CcRkCCOgpQDCuZ1+oCgEEEEAAAQQQQAABBBBAwF8BgnF/PbkbAgTjfAYQQMBoAYJxo9tH8QgggAACCCCAAAIIIIAAAh4FCMY9QnEZAh4FCMY9QnEZAgjoKUAwrmdfqAoBBBBAAAEEEEAAAQQQQMBfAYJxfz25GwIE43wGEEDAaAGCcaPbR/EIIIAAAggggAACCCCAAAIeBQjGPUJxGQIeBQjGPUJxGQII6ClAMK5nX6gKAQQQQAABBBBAAAEEEEDAXwGCcX89uRsCBON8BhBAwGgBgnGj20fxCCCAAAIIIIAAAggggAACHgUIxj1CcRkCHgUIxj1CcRkCCOgpQDCuZ1+oCgEEEEAAAQQQQAABBBBAwF8BgnF/PbkbAgTjfAYQQMBoAYJxo9tH8QgggAACCCCAAAIIIIAAAh4FCMY9QnEZAh4FCMY9QnEZAgjoKUAwrmdfqAoBBBBAAAEEEEAAAQQQQMBfAYJxfz25GwIE43wGEEDAaAGCcaPbR/EIIIAAAhoKFBYWyocffihHjhyRc+fOyfnz56/9Lvq7oKBAbr/99ms/5cqVk7vuukvq1asn9evXl9q1a0vZsmU1XB0lIYAAAgggYK4Awbi5vaNyPQUIxvXsC1UhgIBHAYJxj1BchgACCCCAQByB06dPy+7du2M/e/bskdzc3DhXFz+Umpoq99xzj7Rs2TL2U7NmzeLfxBUIIIAAAgggEFeAYDwuD4MIlFiAYLzEZLwBAQR0EiAY16kb1IIAAgggYJLA2bNnZf369bJt2zb55JNPklp6nTp1JCsrS9q1aycZGRlJnYubI4AAAgggYKsAwbitnWVdYQkQjIclz7wIIOCLAMG4L4zcBAEEEEAgQgLq6fA33nhDfvvb30peXl6gK1f/3G7btq106tRJqlatGujcTIYAAggggIDpAgTjpneQ+nUTIBjXrSPUgwACJRIgGC8RFxcjgAACCERY4OTJk7Jq1Sr5wx/+IPn5+aFKlClTJhaQ9+3bV/hneaitYHIEEEAAAYMECMYNahalGiFAMG5EmygSAQTcBPiPaTcZziOAAAIIIPClwMWLF2XBggXy7rvvivpiTZ2O6tWry7PPPiv33nuvTmVRCwIIIIAAAloKEIxr2RaKMliAYNzg5lE6AggIT5nxIUAAAQQQQCCOwKFDh2TKlCminhbX9UhJSZEuXbpIr169JC0tTdcyqQsBBBBAAIHQBQjGQ28BBVgmQDBuWUNZDgJRE+CJ8ah1nPUigAACCHgRuHr1qqxevVqWLl0qBQUFXt5ywzUqrG7YsKE0atRIKleuLJmZmVKhQoXYj/o7NTVVLly4EPvJzc2Vf/7zn/L3v/9djh49KsePH09oznr16sno0aOlbt26N9TCCwQQQAABBBD4UoBgnE8CAv4KEIz768ndEEAgYAGC8YDBmQ4BBBBAQHuBf/3rXzJ16lTZt29fiWq988475b777pNmzZpJ06ZNJSMjo0TvL7r40qVLsnPnTtm8eXPsd0n+I/6WW26R3r17S+fOnUWF8xwIIIAAAggg8F+Bkvwz9b/v4i8EEHATIBh3k+E8AggYIUAwbkSbKBIBBBBAICCBgwcPyrhx4+SLL77wNKMKn1u0aCE/+tGPpHHjxp7eU5KL8vLy5P333489vf7pp596fuv9998vL7zwgqignAMBBBBAAAEEvhQgGOeTgIC/AgTj/npyNwQQCFiAYDxgcKZDAAEEENBW4PDhwzJq1ChRX7ZZ3FGmTBl56KGHpGvXroFsXaK2dvnLX/4iK1asiG25Ulx9avy73/1uLOTnyXEvWlyDAAIIIBAFAYLxKHSZNQYpQDAepDZzIYCA7wIE476TckMEEEAAAQMF1P7eI0eOFLXfd3HHAw88IEOHDpVq1aoVd6nv44WFhbJs2TJZuXKlqLC8uKNjx44yYMCA4i5jHAEEEEAAgUgIEIxHos0sMkABgvEAsZkKAQT8FyAY99+UOyKAAAIImCVw7NgxGTFihPz73/+OW3h6err06dNHOnToEPr+3Xv37o3tg37mzJm4NavB/v37S6dOnYq9jgsQQAABBBCwXYBg3PYOs76gBQjGgxZnPgQQ8FWAYNxXTm6GAAIIIGCYwNmzZ2PB8blz5+JWXr9+fXnuueekdu3aca8LcjAnJ0dmzJgh27dvjzut2kpl7Nix0qpVq7jXMYgAAggggIDtAgTjtneY9QUtQDAetDjzIYCArwIE475ycjMEEEAAAYME1LYkavuU/fv3x6368ccfl759+0paWlrc68IafPPNN2XRokWSn5/vWoL6Es5p06ZJkyZNXK9hAAEEEEAAAdsFCMZt7zDrC1qAYDxoceZDAAFfBQjGfeXkZggggAACBgm8/vrrsmrVqrgVd+/eXXr06BH3Gh0GDxw4EPvi0Ly8PNdyMjIyZPbs2Vo99e5aLAMIIIAAAggkQYBgPAmo3DLSAgTjkW4/i0fAfAGCcfN7yAoQQAABBEousHv3bhkzZkzcL7B86qmn5Iknnij5zUN6x6ZNm2L7jsebvkGDBjJv3rzQ90iPVyNjCCCAAAIIJEuAYDxZstw3qgIE41HtPOtGwBIBgnFLGskyEEAAAQQ8C+Tm5kqvXr1E7dHtdvTr1086d+7sNqztebWlypo1a+LWN3ToUGnXrl3caxhEAAEEEEDARgGCcRu7yprCFCAYD1OfuRFAoNQCBOOlJuQGCCCAAAKGCRS3hUqHDh1k0KBBhq3qy3KvXr0a+6LNXbt2udZfrlw5WbJkiWRmZrpewwACCCCAAAI2ChCM29hV1hSmAMF4mPrMjQACpRYgGC81ITdAAAEEEDBI4Ny5c7E9wy9duuRY9Ve/+lVZuHChpKenO46bcFI9ET948GA5ceKEa7mPPvqoDBs2zHWcAQQQQAABBGwUIBi3sausKUwBgvEw9ZkbAQRKLUAwXmpCboAAAgggYJDAz372M3nrrbccK05JSZFZs2ZJ48aNHcdNOnn8+PFYOH7hwgXHstPS0mTlypVSsWJFx3FOIoAAAgggYKMAwbiNXWVNYQoQjIepz9wIIFBqAYLxUhNyAwQQQAABQwROnz4de1o8Pz/fseIuXbrI008/7Thm4sl33nknFvS71d6jRw/p3r272zDnEUAAAQQQsE6AYNy6lrKgkAUIxkNuANMjgEDpBAjGS+fHuxFAAAEEzBF488035dVXX3UsuGzZsrJ69WpR+2/bchQWFkqfPn1EPT3udFSqVElWrFgh6ulxDgQQQAABBKIgQDAehS6zxiAFCMaD1GYuBBDwXYBg3HdSbogAAgggoKnAmDFjxO1LKb///e/LqFGjNK088bK2bt0qEydOdL2BMmndurXrOAMIIIAAAgjYJEAwblM3WYsOAgTjOnSBGhBAIGEBgvGE6XgjAggggIBBApcvX5aOHTtKXl6eY9Vz5syRRo0aOY6ZfrJ///5y9OhRx2U89NBDMnbsWMcxTiKAAAIIIGCbAMG4bR1lPWELEIyH3QHmRwCBUgkQjJeKjzcjgAACCBgisHPnTtcAuHbt2rJ48WJDVlLyMuNtIaO2jlm7dq2kpqaW/Ma8AwEEEEAAAcMECMYNaxjlai9AMK59iygQAQTiCRCMx9NhDAEEEEDAZAH1JZv79++XHTt2yJYtW0R9+abTkZWVJaNHj3YasuJcTk6OdO3aVQoKChzXY/PT8o4L5iQCCCCAQGQFCMYj23oWniQBgvEkwXJbBBAIRoBgPBhnZkEAAQQQCE7ggw8+kHXr1snu3bvFy38A9+zZU7p16xZcgSHMNH78eNm+fbvjzN27d5cePXo4jnESAQQQQAABmwS8/HuBTetlLQgkW4BgPNnC3B8BBJIqQDCeVF5ujgACCCAQoMC+fftk+fLlsnfv3hLNGtQXUObm5sqiRYtiT7CrAlu0aCF9+/aVjIyMEtWbyMUbNmyQuXPnOr61ZcuWkp2d7TjGSQQQQAABBGwSIBi3qZusRQcBgnEdukANCCCQsADBeMJ0vBEBBBBAQBOBzz//XGbMmFHiQLyo/OnTp0vTpk2LXiblt6pxxIgRcurUqRvuX7169Vjt1apVu+G83y8OHz4sgwYNcrxtnTp15LXXXnMc4yQCCCCAAAI2CRCM29RN1qKDAMG4Dl2gBgQQSFiAYDxhOt6IAAIIIKCBwNatW2XmzJminsZO9FCh+je/+c1E317s+1QoPnz4cFG/nQ4Viqs1JDMcV/utt2/fXtTvm4+yZcvKxo0bJSUl5eYhXiOAAAIIIGCVAMG4Ve1kMRoIEIxr0ARKQACBxAUIxhO3450IIIAAAuEJXLlyRRYsWCBqi5DSHskMxosLxYtqDyIcHzhwoBw5cqRoyht+qy1okhnM3zAZLxBAAAEEEAhJgGA8JHimtVaAYNza1rIwBKIhQDAejT6zSgQQQMAmAfXU88SJE12/TNJtrWlpaVK7dm2pX7++1K1bNxYEq61M1Dn11LTfh9dQvGjeZIfj48aNu7a/edGcRb9r1aolTZo0kUaNGsV+7rzzTp4gL8LhNwIIIICANQIE49a0koVoIkAwrkkjKAMBBBITIBhPzI13IYAAAgiEI1BYWCiTJ0+WzZs3eyrgtttuk1atWkmbNm3ka1/7mqhwPIijpKF4UU3JDMenTp0qmzZtKpoq7u+aNWvKY489FnML4stB4xbDIAIIIIAAAj4JEIz7BMltEPg/AYJxPgoIIGC0AMG40e2jeAQQQCBSAlevXpWXX35Z/vjHPxa77szMTOndu7dkZWXJrbfeWuz1fl6QaCheVEOywvF58+bJ+vXri6bx9Ds9PV2+973vSc+ePaVixYqe3sNFCCCAAAII6CpAMK5rZ6jLVAGCcVM7R90IIBATIBjng4AAAgggYIqA2gd76dKlxZarng7v27evlC9fvthr/b6gtKF4UT3JCMd/8YtfyIoVK4qmKNHvcuXKidqjXIXkHAgggAACCJgqQDBuaueoW1cBgnFdO0NdCCDgSYBg3BMTFyGAAAIIhCzw0UcfyZAhQ6SgoMC1EvV08/jx46VFixau1yRzwK9QvKhGv8Nx9T8V1P9cKM3RvHlzGT58uFSqVKk0t+G9CCCAAAIIhCJAMB4KO5NaLEAwbnFzWRoCURAgGI9Cl1kjAgggYLbA5cuXZcCAAXL8+HHXhah9sF988UVp3Lix6zXJHPA7FC+q1c9w3I9gXNVVo0aN2JY26otLORBAAAEEEDBJgGDcpG5RqwkCBOMmdIkaEUDAVYBg3JWGAQQQQAABTQTmz58v69atc61GheIzZ86UevXquV6TzIFkheJFNfsVjm/YsEF+85vfFN1WLly4IOfPn5crV65cO+f1j8qVK4v6Ms86dep4fQvXIYAAAgggELoAwXjoLaAAywQIxi1rKMtBIGoCBONR6zjrRQABBMwSOH36tPTo0UPy8/NdC580aZI8+OCDruPJHEh2KF5Uu1/heNH9rv+dm5srx44dkx07dsR+/vGPf1w/7Pq32sN9+vTpof0PCdfCGEAAAQQQQMBFgGDcBYbTCCQoQDCeIBxvQwABPQQIxvXoA1UggAACCDgLLFy4UNauXes8+L9nO3fuLP369XMdT+aA11Bc7cetvhB01apVjuU88cQT8u6778rZs2cdx4tOJjMcL5pD/T5w4IAsXrxYPvjgg+tPO/5ds2ZNefXVV+X22293HOckAggggAACOgkQjOvUDWqxQYBg3IYusgYEIixAMB7h5rN0BBBAQHMB9STzk08+KW7/Eau2Tpk3b56kpaUFvhKvofgdd9wR249bfXmo2nrE6Rg9erQ0bNhQRo4cKWfOnHG65Nq5oMJxNeG2bdvkpz/9qeTk5Fyb3+mPli1bSnZ2ttMQ5xBAAAEEENBKwO3fKbQqkmIQMEiAYNygZlEqAgj8fwGC8f9vwhkEEEAAAT0EVq9eLT//+c9di3n++efl29/+tut4sga8huJVq1aNbTWinqretGlT3GA8KytLPvvsMxkxYoSo7WPiHUGG46dOnZLx48dLcdurqKf21dP7HAgggAACCOgsQDCuc3eozUQBgnETu0bNCCBwTYBg/BoFfyCAAAIIaCYwdOhQOXjwoGNVdevWFbXNSkpKiuN4sk56DcWrV68uM2bMEBViq8NLMK6uU/dX4bgKpOMdQYbjFy9elAkTJsi+fftcS0pPT5df/vKXUrFiRddrGEAAAQQQQCBsAYLxsDvA/LYJEIzb1lHWg0DEBAjGI9ZwlosAAggYIqDC2I4dO0pBQYFjxWr7EfWUdZCH11BcPSGuQvEqVapcK89rMK7eoJ4YV+G4eoI83hFkOK62tRk8eLCcOHHCtaROnTpJ//79XccZQAABBBBAIGwBgvGwO8D8tgkQjNvWUdaDQMQECMYj1nCWiwACCBgisH379tgWHk7lpqamyq9//WvJyMhwGk7KOa+heK1atWLbp1SuXPmGOkoSjKs3qr3G1Z7jx48fv+E+N78IMhxXobgKx1VI7nSop8aXLVsm6stGORBAAAEEENBRgGBcx65Qk8kCBOMmd4/aEUBACMb5ECCAAAII6Cgwf/58WbdunWNp99xzj7zyyiuOY8k46TUUr1OnTuyLNp22EylpMK7Wce7cORk1alSx+3sHGY5v3LhR5syZ48rctWtX6dOnj+s4AwgggAACCIQpQDAepj5z2yhAMG5jV1kTAhESIBiPULNZKgIIIGCQgPrCR/XUuNPRrVs36dmzp9OQ7+e8huL16tWLheKZmZmONSQSjKsb5eTkxMLxjz/+2PG+RSeDCscLCwvl6aeflk8//bRo6ht+33XXXXG/MPWGi3mBAAIIIIBAwAIE4wGDM531AgTj1reYBSJgtwDBuN39ZXUIIICAqQJDhgyRDz/80LH8MWPGSOvWrR3H/DzpNRRv0KCBTJs2TcqVK+c6faLBuLrhF198Ic8++6wcOXLE9f5qIKhwfMuWLTJp0iTXWlasWCFVq1Z1HWcAAQQQQACBsAQIxsOSZ15bBQjGbe0s60IgIgIE4xFpNMtEAAEEDBPo0aOHnDx50rHql19+WZo1a+Y45tdJr6H417/+dXnppZeK3e+8NMG4WpPa1/u5556TQ4cOxV1iEOH4lStXRH3Rplu4MGzYMHn00Ufj1skgAggggAACYQi4/bMrjFqYEwEbBAjGbegia0AgwgIE4xFuPktHAAEENBbo0KGDXLx40bHCRYsWSd26dR3H/DiZn58vAwcOlGPHjsW9XePGjWXKlCly2223xb1ODZY2GFf3UB7qafkDBw6ol66Hspk3b57ccsstrteUdkA9Ma6eHHc6srKyZPTo0U5DnEMAAQQQQCBUAYLxUPmZ3EIBgnELm8qSEIiSAMF4lLrNWhFAAAFzBNq2bSsqoHY6Vq5cKVWqVHEa8uXcO++8I7NmzYp7r2984xvy4osvev4Saz+CcVWQ+g/6cePGyf79++PW95Of/EQeeeSRuNeUZvDtt9+W2bNnO96iadOmMn36dMcxTiKAAAIIIBCmAMF4mPrMbaMAwbiNXWVNCERIgGA8Qs1mqQgggIBBAj/84Q/l/PnzjhUvWLBA6tev7zjmx8m5c+fKhg0bXG913333xfbYTk9Pd73m5gG/gnF138uXL8uECRNkz549N09z7fVjjz0mgwcPvvba7z927doVe3rd6b516tSR1157zWmIcwgggAACCIQqQDAeKj+TWyhAMG5hU1kSAlESIBiPUrdZKwIIIGCOQO/eveXEiROOBU+ePFmaN2/uOObHyTfeeEMWL17seCs17/PPPy9ly5Z1HHc76WcwrubIy8uT7OxsUQG109GnTx/p2rWr05Av544ePSr9+/d3vFeFChVkzZo1jmOcRAABBBBAIEwBgvEw9ZnbRgGCcRu7ypoQiJAAwXiEms1SEUAAAYMEhg4dKgcPHnSseMSIEdKmTRvHMT9O5uTkyIABA+T06dM33O7BBx+U8ePHJ7R3t9/BuCpMfQmm2ut7+/btN9SptpmZP3++ZGZm3nDezxfK5sknn3S8pdrbXG1Hw4EAAggggIBuAgTjunWEekwXIBg3vYPUj0DEBQjGI/4BYPkIIICApgJqj2+3cPXxxx+PfTlmMktXwe/rr78e266ksLBQWrVqFQvLy5Qpk9C0yQjGVSEFBQWxEPz999+X1NRUUdu8PPXUU0ndg13NG++J8Ro1asiyZcvUZRwIIIAAAghoJUAwrlU7KMYCAYJxC5rIEhCIsgDBeJS7z9oRQAABfQU2btwoc+bMcSywWrVqsnz5cscxXU8mKxgPa73x9hi///77ZerUqWGVxrwIIIAAAgi4ChCMu9IwgEBCAgTjCbHxJgQQ0EWAYFyXTlAHAggggMD1Ah999JE888wz15+64e9kfwHnDZP58MK2YPztt9+W2bNnO8q0b99ehgwZ4jjGSQQQQAABBMIUIBgPU5+5bRQgGLexq6wJgQgJEIxHqNksFQEEEDBIQG1for488vz5845VqzH1BZOmHLYF42pv8y1btjjy9+vXTzp37uw4xkkEEEAAAQTCFCAYD1OfuW0UIBi3sausCYEICRCMR6jZLBUBBBAwTGDu3LmyYcMGx6rT09NlyZIlSd9L23HyBE7aFIzn5eVJp06d5NKlS44S2dnZ0rJlS8cxTiKAAAIIIBCmAMF4mPrMbaMAwbiNXWVNCERIgGA8Qs1mqQgggIBhAgcOHJBhw4a5Vp2VlSWjR492HddpwKZg/L333pPJkyc78qovAFX7v1epUsVxnJMIIIAAAgiEKUAwHqY+c9soQDBuY1dZEwIREiAYj1CzWSoCCCBgmMDVq1dFbctx7Ngxx8pTUlJk5syZ0qRJE8dxnU7aEozn5+fLj3/8Y/nss88ceb/zne/IhAkTHMc4iQACCCCAQNgCBONhd4D5bRMgGLeto6wHgYgJEIxHrOEsFwEEEDBMYOvWrTJx4kTXqjMzM0VtuVKjRg3Xa3QYsCUYX7t2rSxcuNCVdNasWXLvvfe6jjOAAAIIIIBAmAIE42HqM7eNAgTjNnaVNSEQIQGC8Qg1m6UigAACBgqop8YHDBggR48eda2+Vq1a8sorr0hGRobrNWEP2BCMHzp0SEaMGCGXL1925GzYsKHMmzfPcYyTCCCAAAII6CBAMK5DF6jBJgGCcZu6yVoQiKAAwXgEm86SEUAAAcME/va3v8nIkSOloKDAtfLGjRvHnixXT5DreJgejH/++ecyaNAgOX/+vCuv2u9d7fvOgQACCCCAgK4CBOO6doa6TBUgGDe1c9SNAAIxAYJxPggIIIAAAiYIrFu3TubPnx+31GrVqkl2drbcfffdca8LY9DkYFztJz527Fg5ceKEK13VqlVl6dKlkpaW5noNAwgggAACCIQtQDAedgeY3zYBgnHbOsp6EIiYAMF4xBrOchFAAAGDBV566SX505/+FHcF6enpMmTIEPnBD34Q97qgB00Nxnfu3CnKPTc315VMheHqS1AbNWrkeg0DCCCAAAII6CBAMK5DF6jBJgGCcZu6yVoQiKAAwXgEm86SEUAAAUMF1N7WKvT++OOPi12B2u+6V69e8sADDxR7bRAXmBaMnzt3TlauXClvvfWWqH3e4x1Dhw6Vdu3axbuEMQQQQAABBLQQIBjXog0UYZEAwbhFzWQpCERRgGA8il1nzQgggIC5AidPnpSBAwfGfYL5+tWpvccffvhh+da3viV33HHH9UOB/m1KMK62S/nd734n69evd/2Szevh2rRpE/tCzuvP8TcCCCCAAAK6ChCM69oZ6jJVgGDc1M5RNwIIxAQIxvkgIIAAAgiYJvDXv/5VJk2aJBcvXixR6XXr1pVmzZqJ2g+7QoUKsZ/y5ctLmTJlSnSf6y9W98rIyLj+lOPffgTjZ86ckZycHMf7l/Skegpc+aknw9UXan7yySeya9cuUf/jwevRoEEDmT17tpQtW9brW7gOAQQQQACBUAUIxkPlZ3ILBQjGLWwqS0IgSgIE41HqNmtFAAEE7BFQXwg5ZcoUOXz4cKiLKleuXGzLFrWVSGpqqmstpQnGz549G9vne+/eva73D3qgXr168uKLL0qVKlWCnpr5EEAAAQQQSFiAYDxhOt6IgKMAwbgjCycRQMAUAYJxUzpFnQgggAACNwvk5+fLkiVLZM2aNcXug33ze/1+3bx581hQnJKS4njrRINxtUa1r/qRI0cc7xvGybZt28ozzzwj6otOORBAAAEEEDBJgGDcpG5RqwkCBOMmdIkaEUDAVYBg3JWGAQQQQAABQwTU1irTpk2LbQsSZsnZ2dnSsmVLxxISDcY3b94sL7zwguM9gz556623yrBhwyQrKyvoqZkPAQQQQAABXwQIxn1h5CYIXBMgGL9GwR8IIGCiAMG4iV2jZgQQQACBmwXUXtnz58+X9957L7Snx3v27CndunW7ubTY60SD8eXLl8vSpUsd7xnkSbU/+/jx46VWrVpBTstcCCCAAAII+CpAMO4rJzdDQAjG+RAggIDRAgTjRreP4hFAAAEEbhJQe4//6le/kt///vdy5cqVm0aT+3LMmDHSunVrx0kSDcb//Oc/x/ZSd7xpkk+qbWHUFjHt27eP/XbbJibJZXB7BBBAAAEEfBMgGPeNkhshEBMgGOeDgAACRgsQjBvdPopHAAEEEHARyM3NlW3btsmWLVtkz549kpeX53KlP6cbNWokM2fOlLS0NMcbJhqMqz3Ghw8fLgcPHnS8bzJOVqpUSR5++GF55JFHpFq1asmYgnsigAACCCAQigDBeCjsTGqxAMG4xc1laQhEQYBgPApdZo0IIIBAtAUuX74sR48evfZz6tQpuXDhwrWfq1evJgSknqCuUqWKtGjRQrp06RL3yygTDcZVYap+9RT8jh075PTp075sFaNqL1++fCz4VuG3+qlevbpUrVpV7r77bteAPyEo3oQAAggggIAmAgTjmjSCMqwRIBi3ppUsBIFoChCMR7PvrBoBBBBAIFiB0gTjwVbKbAgggAACCNgrQDBub29ZWTgCBOPhuDMrAgj4JEAw7hMkt0EAAQQQQCCOAMF4HByGEEAAAQQQCEiAYDwgaKaJjADBeGRazUIRsFOAYNzOvrIqBBBAAAG9BAjG9eoH1SCAAAIIRFOAYDyafWfVyRMgGE+eLXdGAIEABAjGA0BmCgQQQACByAsQjEf+IwAAAggggIAGAgTjGjSBEqwSIBi3qp0sBoHoCRCMR6/nrBgBBBBAIHgBgvHgzZkRAQQQQACBmwUIxm8W4TUCpRMgGC+dH+9GAIGQBQjGQ24A0yOAAAIIREKAYDwSbWaRCCCAAAKaCxCMa94gyjNOgGDcuJZRMAIIXC9AMH69Bn8jgAACCCCQHAGC8eS4clcEEEAAAQRKIkAwXhItrkWgeAGC8eKNuAIBBDQWIBjXuDmUhgACCCBgjQDBuDWtZCEIIIAAAgYLEIwb3DxK11KAYFzLtlAUAgh4FSAY9yrFdQgggAACCCQuQDCeuB3vRAABBBBAwC8BgnG/JLkPAl8KEIzzSUAAAaMFCMaNbh/FI4AAAggYIkAwbkijKBMBBBBAwGoBgnGr28viQhAgGA8BnSkRQMA/AYJx/yy5EwIIIIAAAm4CBONuMpxHAAEEEEAgOAGC8eCsmSkaAgTj0egzq0TAWgGCcWtby8IQQAABBDQSIBjXqBmUggACCCAQWQGC8ci2noUnSYBgPEmw3BYBBIIRIBgPxplZEEAAAQSiLUAwHu3+s3oEEEAAAT0ECMb16ANV2CNAMG5PL1kJApEUIBiPZNtZNAIIIIBAwAIE4wGDMx0CCCCAAAIOAgTjDiicQqAUAgTjpcDjrQggEL4AwXj4PaACBBBAAAH7BQjG7e8xK0QAAQQQ0F+AYFz/HlGhWQIE42b1i2oRQOAmAYLxm0B4iQACCCCAQBIECMaTgMotEUAAAQQQKKEAwXgJwbgcgWIECMaLAWIYAQT0FiAY17s/VIcAAgggYIcAwbgdfWQVCCCAAAJmCxCMm90/qtdPgGBcv55QEQIIlECAYLwEWFyKAAIIIIBAggIE4wnC8TYEEEAAAQR8FCAY9xGTWyHwvwIE43wMEEDAaAGCcaPbR/EIIIAAAoYIEIwb0ijKRAABBBCwWoBg3Or2srgQBAjGQ0BnSgQQ8E+AYNw/S+6EAAIIIICAmwDBuJsM5xFAAAEEEAhOgGA8OGtmioYAwXg0+swqEbBWgGDc2tayMAQQQAABjQQIxjVqBqUggAACCERWgGA8sq1n4UkSIBhPEiy3RQCBYAQIxoNxZhYEEEAAgWgLEIxHu/+sHgEEEEBADwGCcT36QBX2CPwPUZmV/2loHDsAAAAASUVORK5CYII="; // Пример Base64 строки


function base64ToFile(base64String, filename) {
    // Удаляем префикс, если он есть
    const arr = base64String.split(',');
    const mime = arr[0].match(/:(.*?);/)[1];
    const bstr = atob(arr[1]);
    let n = bstr.length;
    const u8arr = new Uint8Array(n);

    while (n--) {
        u8arr[n] = bstr.charCodeAt(n);
    }

    const blob = new Blob([u8arr], { type: mime });
    const url = URL.createObjectURL(blob);

    // Создаем ссылку для скачивания
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}


function canAsync(cadesplugin: CADESPlugin): cadesplugin is CADESPluginAsync {
    return !!(cadesplugin as CADESPluginAsync).CreateObjectAsync;
}

async function testSign(): Promise<void> {
    const thumbprint = 'AA476BAC99432503C5CB6DF90E879A39617150DE'
    if (canAsync(cadesplugin)) {
        const signature = await SignCreate(cadesplugin, thumbprint, testBase64String);
        if (signature !== null) {
            // const result = await SignVerify(cadesplugin, signature, 'data');
            const signatureBase64String = `data:application/octet-stream;base64,${signature}`;
            base64ToFile(signatureBase64String, 'test.png.sig');
        }
    } else {
        const signature = SignCreateSync(cadesplugin, thumbprint, testBase64String);
        if (signature !== null) {
            // const result = SignVerifySync(cadesplugin, signature, 'data');
            const signatureBase64String = `data:application/octet-stream;base64,${signature}`;
            base64ToFile(signatureBase64String, 'test.png.sig');
        }
    }
}

async function testListCertificates(): Promise<void> {
    if (canAsync(cadesplugin)) {
        await getCertificatesList(cadesplugin);
    } else {
        getCertificatesListSync(cadesplugin);
    }
}

async function getCertificatesList(cadesplugin: CADESPluginAsync): Promise<void> {
    const store = await cadesplugin.CreateObjectAsync('CAPICOM.Store');

    await store.Open(
        cadesplugin.CAPICOM_CURRENT_USER_STORE,
        cadesplugin.CAPICOM_MY_STORE,
        cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);

    const certificates = await store.Certificates;

    const div = document.getElementById('certs');
    if (div) {
        const certCount = await certificates.Count;
        for (let i = 1; i <= certCount; ++i) {
            const cert = await certificates.Item(i);
            const elem = document.createElement('p');
            elem.innerHTML = `${await cert.Thumbprint}<br/>${await cert.SubjectName}`;
            div.appendChild(elem);
        }
    }

    await store.Close();
}

function getCertificatesListSync(cadesplugin: CADESPluginSync): void {
    const store = cadesplugin.CreateObject('CAPICOM.Store');

    store.Open(
        cadesplugin.CAPICOM_CURRENT_USER_STORE,
        cadesplugin.CAPICOM_MY_STORE,
        cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);

    const div = document.getElementById('certs');
    if (div) {
        for (let i = 1; i <= store.Certificates.Count; ++i) {
            const cert = store.Certificates.Item(i);
            const elem = document.createElement('p');
            elem.innerHTML = `${cert.Thumbprint}<br/>${cert.SubjectName}`;
            div.appendChild(elem);
        }
    }

    store.Close();
}

async function SignCreate(cadesplugin: CADESPluginAsync, thumbprint: string, dataToSign: string): Promise<string | null> {
    const store = await cadesplugin.CreateObjectAsync('CAPICOM.Store');

    await store.Open(
        cadesplugin.CAPICOM_CURRENT_USER_STORE,
        cadesplugin.CAPICOM_MY_STORE,
        cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);

    const certs = await store.Certificates;
    const result = await certs.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH, thumbprint);

    if (await result.Count < 1) {
        alert('Certificate not found.');
        return null;
    }

    const cert = await result.Item(1);
    const signer = await cadesplugin.CreateObjectAsync('CAdESCOM.CPSigner');
    await signer.propset_Certificate(cert);

    const signedData = await cadesplugin.CreateObjectAsync('CAdESCOM.CadesSignedData');
    await signedData.propset_ContentEncoding(cadesplugin.CADESCOM_BASE64_TO_BINARY);
    await signedData.propset_Content(dataToSign);

    let signedMessage = '';
    try {
        signedMessage = await signedData.SignCades(signer, cadesplugin.CADESCOM_CADES_BES, true);
    } catch (err) {
        alert(cadesplugin.getLastError(err));
        return null;
    }

    await store.Close();
    return signedMessage;
}

function SignCreateSync(cadesplugin: CADESPluginSync, thumbprint: string, dataToSign: string): string | null {
    const store = cadesplugin.CreateObject('CAPICOM.Store');

    store.Open(
        cadesplugin.CAPICOM_CURRENT_USER_STORE,
        cadesplugin.CAPICOM_MY_STORE,
        cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);

    const result = store.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH, thumbprint);

    if (result.Count < 1) {
        alert('Certificate not found.');
        return null;
    }

    const cert = result.Item(1);
    const signer = cadesplugin.CreateObject('CAdESCOM.CPSigner');
    signer.Certificate = cert;

    const signedData = cadesplugin.CreateObject('CAdESCOM.CadesSignedData');
    signedData.ContentEncoding = cadesplugin.CADESCOM_BASE64_TO_BINARY;
    signedData.Content = dataToSign;

    let signedMessage = '';
    try {
        signedMessage = signedData.SignCades(signer, cadesplugin.CADESCOM_CADES_BES, true);
    } catch (err) {
        alert(cadesplugin.getLastError(err));
        return null;
    }

    store.Close();

    return signedMessage;
}

async function SignVerify(cadesplugin: CADESPluginAsync, signature: string, origData: string): Promise<boolean> {
    const data = await cadesplugin.CreateObjectAsync('CAdESCOM.CadesSignedData');
    try {
        await data.propset_ContentEncoding(cadesplugin.CADESCOM_BASE64_TO_BINARY);
        await data.propset_Content(origData);
        await data.VerifyCades(signature, cadesplugin.CADESCOM_CADES_BES, true);
        return true;
    } catch (err) {
        alert(cadesplugin.getLastError(err));
        return false;
    }
}

function SignVerifySync(cadesplugin: CADESPluginSync, signature: string, origData: string): boolean {
    const data = cadesplugin.CreateObject('CAdESCOM.CadesSignedData');
    try {
        data.ContentEncoding = cadesplugin.CADESCOM_BASE64_TO_BINARY;
        data.Content = origData;
        data.VerifyCades(signature, cadesplugin.CADESCOM_CADES_BES, true);
        return true;
    } catch (err) {
        alert(cadesplugin.getLastError(err));
        return false;
    }
}

